# –ß–∞—Å—Ç—å 3: –†–∞–±–æ—Ç–∞ —Å –°–æ–æ–±—â–µ–Ω–∏—è–º–∏

–í —ç—Ç–æ–π —á–∞—Å—Ç–∏ –º—ã –¥–µ—Ç–∞–ª—å–Ω–æ —Ä–∞–∑–±–µ—Ä–µ–º, –∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫—Ä–∞—Å–∏–≤—ã–µ, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è: —Å —Ä–∞–∑–º–µ—Ç–∫–æ–π, –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞–º–∏ –∏ —Ñ–∞–π–ª–∞–º–∏.

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (MessageBuilder)](#—Å–æ–∑–¥–∞–Ω–∏–µ-—Å–æ–æ–±—â–µ–Ω–∏—è-messagebuilder)
2. [–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞](#—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-—Ç–µ–∫—Å—Ç–∞)
3. [–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã](#–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã)
4. [–í–ª–æ–∂–µ–Ω–∏—è –∏ –ú–µ–¥–∏–∞](#–≤–ª–æ–∂–µ–Ω–∏—è-–∏-–º–µ–¥–∏–∞)
5. [–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π](#—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-—Å–æ–æ–±—â–µ–Ω–∏–π)

---

## –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (MessageBuilder)

–î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–∞—Ç—Ç–µ—Ä–Ω **Builder**. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ —à–∞–≥ –∑–∞ —à–∞–≥–æ–º.

```php
use Looksmaxxer\Builders\MessageBuilder;

// 1. –°–æ–∑–¥–∞–µ–º –±–∏–ª–¥–µ—Ä, —É–∫–∞–∑—ã–≤–∞—è ID —á–∞—Ç–∞
$msg = MessageBuilder::create('12345')
    ->text('–ü—Ä–∏–≤–µ—Ç!'); // 2. –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç

// 3. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º
$sentMessage = $client->sendMessage($msg);

// –í –æ—Ç–≤–µ—Ç –º—ã –ø–æ–ª—É—á–∞–µ–º –æ–±—ä–µ–∫—Ç Message —Å ID –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
echo "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ ID: " . $sentMessage->getMid();
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ü–∏–∏:**
*   `->replyTo('MID')`: –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ.
*   `->forwardFrom('MID')`: –ü–µ—Ä–µ—Å–ª–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ.
*   `->notify(false)`: –û—Ç–ø—Ä–∞–≤–∏—Ç—å –±–µ–∑ –∑–≤—É–∫–∞ (—Ç–∏—Ö–æ).
*   `->disableLinkPreview()`: –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–µ–≤—å—é —Å—Å—ã–ª–æ–∫ –≤ —Ç–µ–∫—Å—Ç–µ.

---

## –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞

MAX –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–∑–º–µ—Ç–∫–∏: **Markdown** –∏ **HTML**. –ß—Ç–æ–±—ã –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç –≤ –±–∏–ª–¥–µ—Ä–µ.

–ú—ã —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ö–µ–ª–ø–µ—Ä `Formatting`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ —Å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

```php
use Looksmaxxer\Enums\ParseMode;
use Looksmaxxer\Helpers\Formatting;

$userId = 12345;
$userName = "–ò–≤–∞–Ω";

// HTML
$htmlText = "–ü—Ä–∏–≤–µ—Ç, " . Formatting::htmlMention($userId, $userName) . "!\n";
$htmlText .= "–í–æ—Ç –Ω–∞—à–∞ " . Formatting::htmlLink('–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è', 'https://max.ru');

$client->sendMessage(
    MessageBuilder::create($chatId)
        ->text($htmlText)
        ->format(ParseMode::HTML)
);

// Markdown
$mdText = "–¢–µ–∫—Å—Ç *–∂–∏—Ä–Ω—ã–π* –∏ _–∫—É—Ä—Å–∏–≤_.\n";
$mdText .= Formatting::markdownLink('–ö–ª–∏–∫–Ω–∏ –º–µ–Ω—è', 'https://google.com');

$client->sendMessage(
    MessageBuilder::create($chatId)
        ->text($mdText)
        ->format(ParseMode::MARKDOWN)
);
```

---

## –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

–ö–Ω–æ–ø–∫–∏ (Inline Keyboard) –ø—Ä–∏–∫—Ä–µ–ø–ª—è—é—Ç—Å—è –ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–µ–º. –û–Ω–∏ –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–∞–∑–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è.

–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `InlineKeyboard` –∏ –∫–ª–∞—Å—Å `Button`.

### –¢–∏–ø—ã –∫–Ω–æ–ø–æ–∫

1.  **Callback**: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏–µ –±–æ—Ç—É (–±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç).
2.  **Link**: –û—Ç–∫—Ä—ã–≤–∞–µ—Ç URL –≤ –±—Ä–∞—É–∑–µ—Ä–µ.
3.  **Message**: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç –≤ —á–∞—Ç –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫–∞–∫ –±—É–¥—Ç–æ –æ–Ω —Å–∞–º –Ω–∞–ø–∏—Å–∞–ª).
4.  **Open App**: –ó–∞–ø—É—Å–∫–∞–µ—Ç Mini App.
5.  **Request Geo/Contact**: –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### –¶–≤–µ—Ç–∞ –∫–Ω–æ–ø–æ–∫ (Intent)
–í—ã –º–æ–∂–µ—Ç–µ –º–µ–Ω—è—Ç—å —Ü–≤–µ—Ç –∫–Ω–æ–ø–æ–∫ —á–µ—Ä–µ–∑ `Intent`:
*   `DEFAULT`: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è (—Å–µ—Ä–∞—è/–±–µ–ª–∞—è).
*   `POSITIVE`: –ó–µ–ª–µ–Ω–∞—è/–°–∏–Ω—è—è (–¥–µ–π—Å—Ç–≤–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è).
*   `NEGATIVE`: –ö—Ä–∞—Å–Ω–∞—è (—É–¥–∞–ª–µ–Ω–∏–µ/–æ—Ç–º–µ–Ω–∞).

### –ü—Ä–∏–º–µ—Ä —Å–ª–æ–∂–Ω–æ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

```php
use Looksmaxxer\Models\Keyboard\InlineKeyboard;
use Looksmaxxer\Models\Keyboard\Button;
use Looksmaxxer\Enums\Intent;

$keyboard = InlineKeyboard::create()
    // –†—è–¥ 1: –°—Å—ã–ª–∫–∞ –∏ Callback
    ->addRow(
        Button::link('üåç –ù–∞—à —Å–∞–π—Ç', 'https://mysite.com'),
        Button::callback('‚ÑπÔ∏è –ò–Ω—Ñ–æ', 'get_info')
    )
    // –†—è–¥ 2: –í–∞–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —Å —Ü–≤–µ—Ç–∞–º–∏
    ->addRow(
        Button::callback('‚úÖ –ü—Ä–∏–Ω—è—Ç—å', 'accept', Intent::POSITIVE),
        Button::callback('‚ùå –û—Ç–∫–∞–∑–∞—Ç—å', 'reject', Intent::NEGATIVE)
    )
    // –†—è–¥ 3: –ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
    ->addRow(
        Button::requestGeoLocation('üìç –ì–¥–µ —è?', quick: true) // quick=true —à–ª–µ—Ç –±–µ–∑ –ª–∏—à–Ω–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤
    );

$client->sendMessage(
    MessageBuilder::create($chatId)
        ->text('–ú–µ–Ω—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:')
        ->inlineKeyboard($keyboard)
);
```

---

## –í–ª–æ–∂–µ–Ω–∏—è –∏ –ú–µ–¥–∏–∞

–í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, —Ñ–∞–π–ª—ã, —Å—Ç–∏–∫–µ—Ä—ã –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã. –ï—Å—Ç—å –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å: –ø–æ URL –∏ –ø–æ —Ç–æ–∫–µ–Ω—É (–ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏).

### –°–ø–æ—Å–æ–± 1: –•–µ–ª–ø–µ—Ä—ã (–ü—Ä–æ—Å—Ç–æ)

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–∞–π–ª –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ:

```php
$client->sendMessage(
    MessageBuilder::create($chatId)
        ->text('–î–µ—Ä–∂–∏ –∫–æ—Ç–∞')
        ->photoUrl('https://example.com/cat.jpg')
);
```

### –°–ø–æ—Å–æ–± 2: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ (–ù–∞–¥–µ–∂–Ω–æ)

–ï—Å–ª–∏ —Ñ–∞–π–ª –ª–µ–∂–∏—Ç —É –≤–∞—Å –Ω–∞ –¥–∏—Å–∫–µ, –µ–≥–æ —Å–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–µ—Ç–æ–¥–æ–º `uploadFile`. –û–Ω –≤–µ—Ä–Ω–µ—Ç –æ–±—ä–µ–∫—Ç `Attachment`, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å.

```php
use Looksmaxxer\Enums\UploadType;

// 1. –ó–∞–≥—Ä—É–∂–∞–µ–º –≤–∏–¥–µ–æ
$videoAttachment = $client->uploadFile('/var/www/bot/video.mp4', UploadType::VIDEO);

// 2. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º
$client->sendMessage(
    MessageBuilder::create($chatId)
        ->text('–í–∏–¥–µ–æ —Å —Å–µ—Ä–≤–µ—Ä–∞')
        ->addAttachment($videoAttachment)
);
```

**–î—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã –±–∏–ª–¥–µ—Ä–∞:**
*   `->sticker('STICKER_CODE')`
*   `->contact('–ò–º—è', 'Phone')`
*   `->location($lat, $lon)`
*   `->audio($token)`
*   `->file($token)`

---

## –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

–ë–æ—Ç –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–æ –Ω–µ —á—É–∂–∏–µ). –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `MessageEditBuilder`.

```php
use Looksmaxxer\Builders\MessageEditBuilder;

$client->editMessage(
    MessageEditBuilder::create('MESSAGE_ID_TO_EDIT')
        ->text('–¢–µ–∫—Å—Ç –∏–∑–º–µ–Ω–∏–ª—Å—è! üéâ')
        ->clearAttachments() // –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–Ω–æ–ø–∫–∏ –∏–ª–∏ —Ñ–æ—Ç–æ
);
```